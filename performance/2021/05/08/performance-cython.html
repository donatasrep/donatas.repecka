<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Performance Analysis - Cython | Deep learning</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Performance Analysis - Cython" />
<meta name="author" content="Donatas Repečka" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Number of effective sequences implemented in Cython" />
<meta property="og:description" content="Number of effective sequences implemented in Cython" />
<link rel="canonical" href="https://donatasrep.github.io/donatas.repecka/performance/2021/05/08/performance-cython.html" />
<meta property="og:url" content="https://donatasrep.github.io/donatas.repecka/performance/2021/05/08/performance-cython.html" />
<meta property="og:site_name" content="Deep learning" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-08T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://donatasrep.github.io/donatas.repecka/performance/2021/05/08/performance-cython.html","@type":"BlogPosting","headline":"Performance Analysis - Cython","dateModified":"2021-05-08T00:00:00-05:00","datePublished":"2021-05-08T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://donatasrep.github.io/donatas.repecka/performance/2021/05/08/performance-cython.html"},"author":{"@type":"Person","name":"Donatas Repečka"},"description":"Number of effective sequences implemented in Cython","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/donatas.repecka/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://donatasrep.github.io/donatas.repecka/feed.xml" title="Deep learning" /><link rel="shortcut icon" type="image/x-icon" href="/donatas.repecka/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/donatas.repecka/">Deep learning</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/donatas.repecka/about/">About Me</a><a class="page-link" href="/donatas.repecka/search/">Search</a><a class="page-link" href="/donatas.repecka/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Performance Analysis -  Cython</h1><p class="page-description">Number of effective sequences implemented in Cython</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-08T00:00:00-05:00" itemprop="datePublished">
        May 8, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Donatas Repečka</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/donatas.repecka/categories/#performance">performance</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/donatasrep/donatas.repecka/tree/master/_notebooks/2021-05-08-performance-cython.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/donatas.repecka/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/donatasrep/donatas.repecka/master?filepath=_notebooks%2F2021-05-08-performance-cython.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/donatas.repecka/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/donatasrep/donatas.repecka/blob/master/_notebooks/2021-05-08-performance-cython.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/donatas.repecka/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h2"><a href="#Setup">Setup </a></li>
<li class="toc-entry toc-h2"><a href="#Getting-data">Getting data </a></li>
</ul><body>
<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-05-08-performance-cython.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <a href="https://donatasrep.github.io/donatas.repecka/performance/2021/04/27/Performance-comparison.html">the previous post</a> I have compared various languages and libraries in terms of their speed. This notebook contains the code used in the comparison as well as some details about the choices made to improve the performance of Cython implementation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">
<a class="anchor" href="#Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup<a class="anchor-link" href="#Setup"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ! pip install pandas</span>
<span class="c1"># ! pip install Cython</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-data">
<a class="anchor" href="#Getting-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting data<a class="anchor-link" href="#Getting-data"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">fasta_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">lineterminator</span><span class="o">=</span><span class="s2">"&gt;"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'seq'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">fasta_df</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seqs</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="s1">'../data/picked_msa.fasta'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just to remind the pseudo code looks like this:</p>

<pre><code>for seq1 in seqs:
  for seq2 in seqs:
    if count_mathes(seq1, seq2) &gt; threshold:
      weight +=1
  meff += 1/weight

meff = meff/(len(seq1)^0.5)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Cython implementation is quite simple, it exploits the symmetry to reduce calculations required, but does not require any other tricks to have decent performance. The overall performance is somewhere between Numpy and Numba.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> Cython
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">cython</span> <span class="o">--</span><span class="n">annotate</span>

<span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">cnp</span>

<span class="k">def</span> <span class="nf">get_nf_cython</span><span class="p">(</span><span class="n">seqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>

    <span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">is_same_cluster</span>
    
    <span class="n">seqs</span> <span class="o">=</span> <span class="n">seqs</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1</span><span class="p">)</span>
    <span class="n">n_seqs</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="n">seqs</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">is_same_cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n_seqs</span><span class="p">,</span> <span class="n">n_seqs</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_seqs</span><span class="p">):</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">seqs</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
        <span class="n">pairwise_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">current</span><span class="p">[</span><span class="mf">1</span><span class="p">:],</span> <span class="n">current</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
        <span class="n">is_more</span> <span class="o">=</span> <span class="n">pairwise_id</span> <span class="o">&gt;</span> <span class="n">threshold</span>
        <span class="n">is_same_cluster</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">is_more</span>
        <span class="n">is_same_cluster</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_more</span>
    <span class="n">meff</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">is_same_cluster</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">meff</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">seq_len</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
&lt;!DOCTYPE html&gt;
<!-- Generated by Cython 0.29.23 -->


    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Cython: _cython_magic_ee6b92b0179f5a65348a99bc0555535b.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>


<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.23</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br>
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<div class="cython">
<pre class="cython line score-0"> <span class="">01</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">02</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython code score-16 ">  __pyx_t_1 = <span class="pyx_c_api">__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class="py_c_api">PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class="error_goto">__PYX_ERR(0, 2, __pyx_L1_error)</span>
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyDict_NewPresized</span>(0);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class="py_c_api">PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class="error_goto">__PYX_ERR(0, 2, __pyx_L1_error)</span>
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
<pre class="cython line score-0"> <span class="">03</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">cnp</span></pre>
<pre class="cython line score-0"> <span class="">04</span>: </pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">05</span>: <span class="k">def</span> <span class="nf">get_nf_cython</span><span class="p">(</span><span class="n">seqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span></pre>
<pre class="cython code score-53 ">/* Python wrapper */
static PyObject *__pyx_pw_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_1get_nf_cython(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_1get_nf_cython = {"get_nf_cython", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_1get_nf_cython, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_1get_nf_cython(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_seqs = 0;
  PyObject *__pyx_v_threshold = 0;
  PyObject *__pyx_r = 0;
  <span class="refnanny">__Pyx_RefNannyDeclarations</span>
  <span class="refnanny">__Pyx_RefNannySetupContext</span>("get_nf_cython (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_seqs,&amp;__pyx_n_s_threshold,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_float_0_8);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class="py_macro_api">PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class="py_macro_api">PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class="py_macro_api">PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class="py_c_api">PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class="pyx_c_api">__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_seqs)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class="pyx_c_api">__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_threshold);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class="pyx_c_api">__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_nf_cython") &lt; 0)) <span class="error_goto">__PYX_ERR(0, 5, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class="py_macro_api">PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class="py_macro_api">PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class="py_macro_api">PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_seqs = values[0];
    __pyx_v_threshold = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class="pyx_c_api">__Pyx_RaiseArgtupleInvalid</span>("get_nf_cython", 0, 1, 2, <span class="py_macro_api">PyTuple_GET_SIZE</span>(__pyx_args)); <span class="error_goto">__PYX_ERR(0, 5, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class="pyx_c_api">__Pyx_AddTraceback</span>("_cython_magic_ee6b92b0179f5a65348a99bc0555535b.get_nf_cython", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class="refnanny">__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_get_nf_cython(__pyx_self, __pyx_v_seqs, __pyx_v_threshold);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class="refnanny">__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_get_nf_cython(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seqs, PyObject *__pyx_v_threshold) {
  PyArrayObject *__pyx_v_is_same_cluster = 0;
  PyObject *__pyx_v_n_seqs = NULL;
  PyObject *__pyx_v_seq_len = NULL;
  CYTHON_UNUSED long __pyx_v_s;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_current = NULL;
  PyObject *__pyx_v_pairwise_id = NULL;
  PyObject *__pyx_v_is_more = NULL;
  PyObject *__pyx_v_meff = NULL;
  PyObject *__pyx_r = NULL;
  <span class="refnanny">__Pyx_RefNannyDeclarations</span>
  <span class="refnanny">__Pyx_RefNannySetupContext</span>("get_nf_cython", 0);
  <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_v_seqs);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_1);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_2);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_3);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_4);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_5);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_8);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_11);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_12);
  <span class="pyx_c_api">__Pyx_AddTraceback</span>("_cython_magic_ee6b92b0179f5a65348a99bc0555535b.get_nf_cython", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class="pyx_macro_api">__Pyx_XDECREF</span>((PyObject *)__pyx_v_is_same_cluster);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_n_seqs);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_seq_len);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_i);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_current);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_pairwise_id);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_is_more);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_meff);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_v_seqs);
  <span class="refnanny">__Pyx_XGIVEREF</span>(__pyx_r);
  <span class="refnanny">__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__4 = <span class="py_c_api">PyTuple_Pack</span>(11, __pyx_n_s_seqs, __pyx_n_s_threshold, __pyx_n_s_is_same_cluster, __pyx_n_s_n_seqs, __pyx_n_s_seq_len, __pyx_n_s_s, __pyx_n_s_i, __pyx_n_s_current, __pyx_n_s_pairwise_id, __pyx_n_s_is_more, __pyx_n_s_meff);<span class="error_goto"> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_tuple__4);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_46_cython_magic_ee6b92b0179f5a65348a99bc0555535b_1get_nf_cython, NULL, __pyx_n_s_cython_magic_ee6b92b0179f5a6534);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class="py_c_api">PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_nf_cython, __pyx_t_1) &lt; 0) <span class="error_goto">__PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
<pre class="cython line score-0"> <span class="">06</span>: </pre>
<pre class="cython line score-0"> <span class="">07</span>:     <span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">is_same_cluster</span></pre>
<pre class="cython line score-0"> <span class="">08</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">09</span>:     <span class="n">seqs</span> <span class="o">=</span> <span class="n">seqs</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">seqs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython code score-69 ">  __pyx_t_3 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_v_seqs, __pyx_n_s_view);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
  <span class="pyx_c_api">__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_uint32);<span class="error_goto"> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_5);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_4);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
      <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : <span class="pyx_c_api">__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2)) <span class="error_goto">__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_2);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_reshape);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_v_seqs, __pyx_n_s_shape);<span class="error_goto"> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class="pyx_c_api">__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class="error_goto"> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_5);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_2);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
      <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class="py_c_api">PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_5, __pyx_int_neg_1};
    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class="pyx_c_api">__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_5, __pyx_int_neg_1};
    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_4 = <span class="py_c_api">PyTuple_New</span>(2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    if (__pyx_t_2) {
      <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_2); <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_t_5);
    <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_int_neg_1);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_v_seqs, __pyx_t_1);
  __pyx_t_1 = 0;
</pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">10</span>:     <span class="n">n_seqs</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="n">seqs</span><span class="o">.</span><span class="n">shape</span></pre>
<pre class="cython code score-46 ">  __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_v_seqs, __pyx_n_s_shape);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class="py_c_api">PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class="py_c_api">PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class="pyx_c_api">__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class="pyx_c_api">__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class="pyx_c_api">__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class="error_goto">__PYX_ERR(0, 10, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class="py_c_api">PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class="py_macro_api">PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class="py_macro_api">PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class="py_macro_api">PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class="py_macro_api">PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_3);
    <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_3 = <span class="py_macro_api">PySequence_ITEM</span>(sequence, 0);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class="py_macro_api">PySequence_ITEM</span>(sequence, 1);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class="py_c_api">PyObject_GetIter</span>(__pyx_t_1);<span class="error_goto"> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_5);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_7(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_4 = __pyx_t_7(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class="pyx_c_api">__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_5), 2) &lt; 0) <span class="error_goto">__PYX_ERR(0, 10, __pyx_L1_error)</span>
    __pyx_t_7 = NULL;
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = NULL;
    if (<span class="pyx_c_api">__Pyx_IterFinish</span>() == 0) <span class="pyx_c_api">__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class="error_goto">__PYX_ERR(0, 10, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_n_seqs = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_seq_len = __pyx_t_4;
  __pyx_t_4 = 0;
</pre>
<pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">11</span>:     <span class="n">is_same_cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n_seqs</span><span class="p">,</span> <span class="n">n_seqs</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span></pre>
<pre class="cython code score-60 ">  <span class="pyx_c_api">__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ones);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class="py_c_api">PyList_New</span>(2);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
  <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_v_n_seqs);
  <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_v_n_seqs);
  <span class="py_macro_api">PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_n_seqs);
  <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_v_n_seqs);
  <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_v_n_seqs);
  <span class="py_macro_api">PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_n_seqs);
  <span class="pyx_c_api">__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class="error_goto"> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class="error_goto"> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_2);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_5);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
      <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class="py_c_api">PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_2};
    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class="pyx_c_api">__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_2};
    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class="py_c_api">PyTuple_New</span>(2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_5) {
      <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_5); <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_6, __pyx_t_4);
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_6, __pyx_t_2);
    __pyx_t_4 = 0;
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class="pyx_c_api">__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class="error_goto">__PYX_ERR(0, 11, __pyx_L1_error)</span>
  __pyx_v_is_same_cluster = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre>
<pre class="cython line score-0"> <span class="">12</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">13</span>:     <span class="n">s</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class="cython code score-0 ">  __pyx_v_s = 0;
</pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">14</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_seqs</span><span class="p">):</span></pre>
<pre class="cython code score-46 ">  __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_n_seqs);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class="py_c_api">PyList_CheckExact</span>(__pyx_t_1)) || <span class="py_c_api">PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1; __pyx_t_3 = <span class="py_c_api">PyObject_GetIter</span>(__pyx_t_1);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_10 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class="error_goto"> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  }
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(<span class="py_c_api">PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_9 &gt;= <span class="py_macro_api">PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class="py_macro_api">PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_9); <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class="error_goto">__PYX_ERR(0, 14, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class="py_macro_api">PySequence_ITEM</span>(__pyx_t_3, __pyx_t_9); __pyx_t_9++;<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
        <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_9 &gt;= <span class="py_macro_api">PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class="py_macro_api">PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_9); <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class="error_goto">__PYX_ERR(0, 14, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class="py_macro_api">PySequence_ITEM</span>(__pyx_t_3, __pyx_t_9); __pyx_t_9++;<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
        <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_10(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class="py_c_api">PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class="pyx_c_api">__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class="py_c_api">PyErr_Clear</span>();
          else <span class="error_goto">__PYX_ERR(0, 14, __pyx_L1_error)</span>
        }
        break;
      }
      <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class="pyx_macro_api">__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">15</span>:         <span class="n">current</span> <span class="o">=</span> <span class="n">seqs</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span></pre>
<pre class="cython code score-3 ">    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyObject_GetSlice</span>(__pyx_v_seqs, 0, 0, &amp;__pyx_v_i, NULL, NULL, 0, 0, 1);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_XDECREF_SET</span>(__pyx_v_current, __pyx_t_1);
    __pyx_t_1 = 0;
</pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">16</span>:         <span class="n">pairwise_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">current</span><span class="p">[</span><span class="mf">1</span><span class="p">:],</span> <span class="n">current</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython code score-74 ">    <span class="pyx_c_api">__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class="error_goto"> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_equal);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class="pyx_c_api">__Pyx_PyObject_GetSlice</span>(__pyx_v_current, 1, 0, NULL, NULL, &amp;__pyx_slice_, 1, 0, 1);<span class="error_goto"> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class="pyx_c_api">__Pyx_GetItemInt</span>(__pyx_v_current, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class="error_goto"> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_11 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_T);<span class="error_goto"> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_11);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_5);
        <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
        <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class="py_c_api">PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_t_11};
      __pyx_t_8 = <span class="pyx_c_api">__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
      <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_8);
      <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class="pyx_c_api">__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_t_11};
      __pyx_t_8 = <span class="pyx_c_api">__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
      <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_8);
      <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    } else
    #endif
    {
      __pyx_t_12 = <span class="py_c_api">PyTuple_New</span>(2+__pyx_t_6);<span class="error_goto"> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
      <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_12);
      if (__pyx_t_5) {
        <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_5); <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_6, __pyx_t_2);
      <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_6, __pyx_t_11);
      __pyx_t_2 = 0;
      __pyx_t_11 = 0;
      __pyx_t_8 = <span class="pyx_c_api">__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_12, NULL);<span class="error_goto"> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
      <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_8);
      <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    }
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_mean);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_8 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_8);
        <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
        <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_8, __pyx_int_1) : <span class="pyx_c_api">__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_int_1);
    <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_1)) <span class="error_goto">__PYX_ERR(0, 16, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class="pyx_macro_api">__Pyx_XDECREF_SET</span>(__pyx_v_pairwise_id, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  __pyx_slice_ = <span class="py_c_api">PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class="error_goto"> if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_slice_);
  <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_slice_);
</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">17</span>:         <span class="n">is_more</span> <span class="o">=</span> <span class="n">pairwise_id</span> <span class="o">&gt;</span> <span class="n">threshold</span></pre>
<pre class="cython code score-6 ">    __pyx_t_1 = <span class="py_c_api">PyObject_RichCompare</span>(__pyx_v_pairwise_id, __pyx_v_threshold, Py_GT); <span class="refnanny">__Pyx_XGOTREF</span>(__pyx_t_1);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_XDECREF_SET</span>(__pyx_v_is_more, __pyx_t_1);
    __pyx_t_1 = 0;
</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">18</span>:         <span class="n">is_same_cluster</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">is_more</span></pre>
<pre class="cython code score-22 ">    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class="py_c_api">PySlice_New</span>(__pyx_t_1, Py_None, Py_None);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class="py_c_api">PyTuple_New</span>(2);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_v_i);
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i);
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
    __pyx_t_4 = 0;
    if (unlikely(<span class="py_c_api">PyObject_SetItem</span>(((PyObject *)__pyx_v_is_same_cluster), __pyx_t_1, __pyx_v_is_more) &lt; 0)) <span class="error_goto">__PYX_ERR(0, 18, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">19</span>:         <span class="n">is_same_cluster</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_more</span></pre>
<pre class="cython code score-22 ">    __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class="py_c_api">PySlice_New</span>(__pyx_t_1, Py_None, Py_None);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class="py_c_api">PyTuple_New</span>(2);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
    <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_v_i);
    <span class="refnanny">__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class="py_macro_api">PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_i);
    __pyx_t_4 = 0;
    if (unlikely(<span class="py_c_api">PyObject_SetItem</span>(((PyObject *)__pyx_v_is_same_cluster), __pyx_t_1, __pyx_v_is_more) &lt; 0)) <span class="error_goto">__PYX_ERR(0, 19, __pyx_L1_error)</span>
    <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">20</span>:     <span class="n">meff</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">is_same_cluster</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython code score-19 ">  __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_is_same_cluster), __pyx_n_s_sum);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_4);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
      <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_int_1) : <span class="pyx_c_api">__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_int_1);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3)) <span class="error_goto">__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class="pyx_c_api">__Pyx_PyFloat_TrueDivideCObj</span>(__pyx_float_1_0, __pyx_t_3, 1.0, 0, 1);<span class="error_goto"> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_meff = __pyx_t_1;
  __pyx_t_1 = 0;
</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">21</span>:     <span class="k">return</span> <span class="n">meff</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">seq_len</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span></pre>
<pre class="cython code score-28 ">  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class="pyx_c_api">__Pyx_PyObject_GetAttrStr</span>(__pyx_v_meff, __pyx_n_s_sum);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class="py_c_api">PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class="py_macro_api">PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class="py_macro_api">PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(__pyx_t_4);
      <span class="pyx_macro_api">__Pyx_INCREF</span>(function);
      <span class="pyx_macro_api">__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? <span class="pyx_c_api">__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class="pyx_c_api">__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class="pyx_macro_api">__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class="error_goto">__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_1);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class="py_c_api">PyNumber_Power</span>(__pyx_v_seq_len, __pyx_float_0_5, Py_None);<span class="error_goto"> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class="pyx_c_api">__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_3);<span class="error_goto"> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class="refnanny">__Pyx_GOTREF</span>(__pyx_t_4);
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class="pyx_macro_api">__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it -n 3 -r 3
    <span class="n">get_nf_cython</span><span class="p">(</span><span class="n">seqs</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>16.6 ms ± 1.57 ms per loop (mean ± std. dev. of 3 runs, 3 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_nf_cython</span><span class="p">(</span><span class="n">seqs</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.18006706787628665</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>


</body>
  </div><a class="u-url" href="/donatas.repecka/performance/2021/05/08/performance-cython.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/donatas.repecka/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/donatas.repecka/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/donatas.repecka/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Blog posts about what interests me</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/donatasrep" target="_blank" title="donatasrep"><svg class="svg-icon grey"><use xlink:href="/donatas.repecka/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/DonatasRepecka" target="_blank" title="DonatasRepecka"><svg class="svg-icon grey"><use xlink:href="/donatas.repecka/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
